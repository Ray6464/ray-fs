const fs=require("fs"),path=require("path"),rayFSVersion="1.6.0",rayFSAuthors="Ray Voice and Anna Voice";module.exports={value:0,dirInAction:".",log:function(){return console.log("ray-fs:",arguments),this},logVal:function(){return this.log(this.value),this},logDir:function(){return this.log(this.dirInAction),this},version:function(){return this.value=`Version: ${rayFSVersion} developed by ${rayFSAuthors}`,this},cd:function(t){console.log(`attempt to change at ${t} from ${this.dirInAction} and ${path.dirname(t)}`);var i=path.join(this.dirInAction,t);return this.exists(i).value&&this.isDir(i).value?(this.dirInAction=i,this.log(`Changed directory to ${t}`)):this.log("No Such File or Directory!"),this},relPath:function(t){return this.value=this.joinPath(`${this.dirInAction}/${t}`).value,this},write:function(t,i){return fs.writeFileSync(this.relPath(t).value,i),this},writeJSON:function(t,i){return this.write(t,JSON.stringify(i,null,2)),this},read:function(t){return this.value=fs.readFileSync(t,"utf8"),this},readJSON:function(t){return this.value=JSON.parse(this.read(t).value),this},readArray:function(t){return this.value=this.read(t).value.split("\n"),this},push:function(t,i){return fs.appendFileSync(this.relPath(t).value,i),this},rm:function(t){var i=this.relPath(t).value;return this.exists(i).value?fs.rmSync(this.relPath(t).value):this.log(`The ${t} does not exist!`),this},cp:function(t,i){var e=this.relPath(t).value,s=this.relPath(i).value;return this.exists(e).value?this.exists(s).value?this.log(`The ${s} already exists!`):fs.copyFileSync(this.relPath(t).value,this.relPath(i).value):this.log(`The ${t} does not exist!`),this},mv:function(t,i){return this.cp(t,i),this.rm(t),this},joinPath:function(t){return this.value=path.join(t),this},exists:function(t){return this.value=fs.existsSync(t),this},mkdir:function(t){var i=this.relPath(t).value;return this.exists(i).value?this.log(`The directory ${t} already exists!`):fs.mkdirSync(i),this},isFile:function(t){return this.value=fs.lstatSync(this.relPath(t).value).isFile(),this},isDir:function(t){return this.value=fs.lstatSync(this.relPath(t).value).isDirectory(),this},ls:function(){return this.value=fs.readdirSync(this.dirInAction),this},lsMatches:function(t){t=this.ls(this.dirInAction).value.filter(t);return this.value=t,this},lsFile:function(){var t=this.lsMatches(t=>this.isFile(t).value).value;return this.value=t,this},lsDir:function(){var t=this.lsMatches(t=>this.isDir(t).value).value;return this.value=t,this},validFileName:function(t){return this.value=/\w\.[a-zA-Z0-9]+$/.test(t),this},validDirName:function(t){return this.value=/\w+/.test(t),this},stream:function(t,i,e,s){const r=fs.createWriteStream(i);t.pipe(r),t.on("error",()=>{console.log("Error: Stream Faild!"),void 0!==e&&e()}),r.on("finish",()=>{console.log("Stream Sucessful!"),void 0!==s&&s()})}};